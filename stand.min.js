!function(a){"function"==typeof define&&define.amd?define(["raphael"],a):a(Raphael)}(function(a){function b(a,b){for(var c=a.centerX,d=a.centerY,e=a.count,f=a.deg,g=a.r,h=0;e>h;h++){var i,j,k;i=2*Math.PI/360*f*h,j=c+Math.sin(i)*g,k=d-Math.cos(i)*g,b(j,k,h)}}function c(a){var b,c=function(a,b){return b[a]?b[a].toString().replace(","," "):!1},d=c("from",a),e=c("to",a),f="M"+d,g="L"+e;return b=d?e?f+g:f:g}function d(a){for(var b="",c=65,d=f.keys(a).length;64+d>c;c++)b+=String.fromCharCode(c)+" ";return b.trim().split(" ").reverse().toString().replace(/,/g,"")}function e(a){this.conf=f.extend(e.DEFAULTS,a),this.init(this.conf)}var f={extend:function(a){for(var b=0;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},keys:function(a){var b=[];for(var c in a)b.push(c);return b},values:function(a){var b=[];for(var c in a)b.push(a[c]);return b}};return e.DEFAULTS={adaptive:!1,container:"stand",centerX:200,centerY:200,count:6,r:150,width:980,height:600,levelTotal:5,figureCount:20},e.prototype.init=function(b){return b.adaptive&&(b=this.adapt(b)),b.sr=b.r-10,b.fr=b.r/1.6,b.deg=360/b.count,b.levelWidth=b.fr/(b.levelTotal+1),b.levelCode=d(b.data.status),this.paper=a(b.container,b.width,b.height),this.styles={circle:{"stroke-width":1.5},glow:{width:1,offsety:3,offsetx:-2,opacity:.3},SL:{"font-size":18,"font-weight":"bold"},SN:{"font-weight":"bold"},innerFigure:{"stroke-width":5},outterFigure:{"stroke-width":5},firstLineStatus:{"font-size":10},area:{"fill-opacity":.3}},this.allCircle().innerLine().levelFigure().levelStatus(),this.circleSet.attr(this.styles.circle),this.decoratorFigure().levelArea(),this.paper},e.prototype.update=function(a){this.conf.data=a,this.decoratorFigure().levelStatus().levelArea()},e.prototype.allCircle=function(){var a,b=this.paper,c=this.conf;return a=b.set(),a.push(b.circle(c.centerX,c.centerY,c.r),b.circle(c.centerX,c.centerY,c.sr),b.circle(c.centerX,c.centerY,c.fr)),a.glow(this.styles.glow),this.circleSet=a,this},e.prototype.innerLine=function(){var a=this.paper,d=this.conf,e=this.circleSet;return b({centerX:d.centerX,centerY:d.centerY,count:d.count,deg:d.deg,r:d.fr},function(b,f){var g=c({from:[d.centerX,d.centerY],to:[b,f]});e.push(a.path(g))}),this},e.prototype.levelFigure=function(){var a=this.paper,c=this.conf,d=this.circleSet;c.levelArr=[];for(var e=0;e<c.levelTotal;e++){var f=c.levelWidth*(e+1);b({centerX:c.centerX,centerY:c.centerY,count:c.count,deg:c.deg,r:f},function(b,e){c.levelArr.push({x:b,y:e}),d.push(a.circle(b,e,1))})}return this},e.prototype.levelStatus=function(){var a,c,d=this.paper,e=this.conf,g=f.keys(e.data.status),h=f.values(e.data.status);return this.SLSet&&this.SNSet&&(this.SLSet.remove(),this.SNSet.remove()),a=d.set(),c=d.set(),b({centerX:e.centerX,centerY:e.centerY,count:e.count,deg:e.deg,r:e.r-40},function(b,c,f){var g=e.levelCode.charAt(h[f]-1);a.push(d.text(b,c,g))}),this.SLSet=a.attr(this.styles.SL),b({centerX:e.centerX,centerY:e.centerY,count:e.count,deg:e.deg,r:e.r-20},function(a,b,f){var h=g[f],i=f*e.deg;i>=90&&270>=i&&(i-=180),c.push(d.text(a,b,h).transform("r"+i))}),this.SNSet=c.attr(this.styles.SN),this},e.prototype.adapt=function(a){var b=document.querySelector("#"+a.container);return a.width=b.clientWidth,a.height=b.clientHeight,a.r=b.clientWidth/4,a.centerX=b.clientWidth/2,a.centerY=b.clientHeight/2,this.conf=a,a},e.prototype.reDraw=function(){this.paper.remove(),this.init(this.conf)},e.prototype.decoratorFigure=function(){this.dfInnerSet&&this.dfOutterSet&&(this.dfInnerSet.remove(),this.dfOutterSet.remove());var a=this.paper,d=this.conf,e=d.centerX,f=d.centerY,g=(d.count,d.deg,d.r),h=d.sr,i=d.figureCount,j=a.set(),k=a.set(),l=[],m=[],n=[];b({centerX:e,centerY:f,count:i,deg:360/i,r:g},function(a,b){m.push({x:a,y:b})}),b({centerX:e,centerY:f,count:i,deg:360/i,r:h},function(a,b){n.push({x:a,y:b})}),b({centerX:e,centerY:f,count:i,deg:360/i,r:g-5},function(a,b){l.push({x:a,y:b})});for(var o=0;o<d.figureCount;o++){var p,q;p=c({from:[n[o].x,n[o].y],to:[l[o].x,l[o].y]}),q=c({from:[l[o].x,l[o].y],to:[m[o].x,m[o].y]}),j.push(a.path(p)),k.push(a.path(q))}this.dfInnerSet=j.attr(this.styles.innerFigure),this.dfOutterSet=k.attr(this.styles.outterFigure);var r=0,s=function(a){r>10||(setTimeout(function(){s(3*r+100)},a+30),j.forEach(function(b,c){var d=j[c],e=k[c],f=c+1==j.length?j[0]:j[c+1],g=0==c?k[k.length-1]:k[c-1];d.animate({path:f.attr("path")[0].toString().replace(","," ")+f.attr("path")[1].toString().replace(","," ")},a,"easeOut"),e.animate({path:g.attr("path")[0].toString().replace(","," ")+g.attr("path")[1].toString().replace(","," ")},a,"easeOut")}),r++)};return s(80),this},e.prototype.levelArea=function(){this.powerArea&&(this.powerArea.remove(),this.firstLineSet.remove());var a=this.paper,b=this.conf,d=b.centerX,e=b.centerY,g=b.count,h=(b.deg,b.r,b.levelWidth,b.levelTotal,b.levelArr),i=b.data,j=[],k=[],l=a.set(),m=1;for(var n in i.status){var o=i.status[n],p=o*g-(g-m)-1,q=h[p];k.push(h[(m-1)*g]),j.push(q),m++}for(var r=0;r<k.length-1;r++){var s=b.levelCode.charAt(r),t=a.text(k[r].x+8,k[r].y-3,s);l.push(t)}l.attr(this.styles.firstLineStatus);var u,v;u=c({from:[d,e]}),v=c({from:[j[0].x,j[0].y]});for(var w=1;w<j.length;w++)v+=c({to:[j[w].x,j[w].y]}),u+=c({to:[d,e]});var x=a.path(u+"Z").animate({path:v+"Z"},1500,"easeOut");return x.attr(f.extend(this.styles.area,{fill:i.theme})).toBack(),this.powerArea=x,this.firstLineSet=l,this},e});